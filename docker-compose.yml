services:
  fuseki:
    image: stain/jena-fuseki:latest
    container_name: rotor-fuseki
    ports:
      - "3030:3030"
    environment:
      - ADMIN_PASSWORD=admin
      - FUSEKI_DATASET_1=rotors
    volumes:
      - fuseki-data:/fuseki

  app:
    build:
      context: .
      args:
        REPO_URL: "https://github.com/Tenny131/rotor-owl-analysis.git"
        REPO_REF: "main"
    image: rotor-owl-app:latest
    container_name: rotor-streamlit
    ports:
      - "8501:8501"
    environment:
      - SPARQL_ENDPOINT_URL=http://fuseki:3030/rotors/sparql
      - ONTOLOGY_PATH=/app/data/rotor_ontologie.owl
    volumes:
      - ./data:/app/data:ro
    depends_on:
      - fuseki

volumes:
  fuseki-data:
